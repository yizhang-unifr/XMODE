id,query_predicted,query_expected,result_predicted,result_expected,query_accuracy,execution_accuracy,VQA
5,"SELECT func_vqa(""Is the cardiac silhouette's width larger than half of the total thorax width?"", ""STUDY_ID"") AS result FROM TB_CXR WHERE ""SUBJECT_ID"" = 10284038 AND strftime('%Y', ""STUDYDATETIME"") = '2105' ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select func_vqa(""is the cardiac silhouette's width larger than half of the total thorax width?"", t1.study_id) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10284038 and strftime('%y',tb_cxr.studydatetime) = '2105' order by tb_cxr.studydatetime desc limit 1 ) ) as t1","   result
0       1","   func_vqa(""is the cardiac silhouette's width larger than half of the total thorax width?"", t1.study_id)
0                                                  1                                                     ",False,True,local
21,"SELECT func_vqa(""Are there any anatomical findings or diseases on this chest X-ray?"", ""STUDY_ID"") FROM ""TB_CXR"" WHERE ""SUBJECT_ID"" = 19243401 AND strftime('%Y', ""STUDYDATETIME"") = strftime('%Y', 'now') ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select (func_vqa(""can you confirm the presence of anatomical findings?"", t1.study_id)) or (func_vqa(""can you confirm the presence of diseases?"", t1.study_id)) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 19243401 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) as t1","Empty DataFrame
Columns: [func_vqa(""Are there any anatomical findings or diseases on this chest X-ray?"", ""STUDY_ID"")]
Index: []","Empty DataFrame
Columns: [(func_vqa(""can you confirm the presence of anatomical findings?"", t1.study_id)) or (func_vqa(""can you confirm the presence of diseases?"", t1.study_id))]
Index: []",False,True,local
49,"SELECT func_vqa(""Identify abnormalities in the abdomen or right chest wall?"", ""STUDY_ID"") FROM ""TB_CXR"" WHERE ""SUBJECT_ID"" = 15491652 AND strftime('%Y-%m', ""STUDYDATETIME"") = '2015-06' ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select (func_vqa(""can you identify any abnormalities in the abdomen?"", t1.study_id)) or (func_vqa(""can you identify any abnormalities in the right chest wall?"", t1.study_id)) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 15491652 and strftime('%y-%m',tb_cxr.studydatetime) = '2105-06' order by tb_cxr.studydatetime desc limit 1 ) ) as t1","Empty DataFrame
Columns: [func_vqa(""Identify abnormalities in the abdomen or right chest wall?"", ""STUDY_ID"")]
Index: []","   (func_vqa(""can you identify any abnormalities in the abdomen?"", t1.study_id)) or (func_vqa(""can you identify any abnormalities in the right chest wall?"", t1.study_id))
0                                                  1                                                                                                                      ",False,False,local
66,"SELECT ""STUDY_ID"", ""study_id_related"" FROM ( SELECT ""STUDY_ID"", func_vqa(""Are there any tubes or lines related to the abdomen?"", ""STUDY_ID"") AS abdomen_findings, func_vqa(""Are there any tubes or lines in the right lung?"", ""STUDY_ID"") AS right_lung_findings, CASE WHEN func_vqa(""Are there any tubes or lines related to the abdomen?"", ""STUDY_ID"") || func_vqa(""Are there any tubes or lines in the right lung?"", ""STUDY_ID"") THEN ""STUDY_ID"" END AS ""study_id_related"" FROM TB_CXR WHERE ""SUBJECT_ID"" = 19243401 AND strftime('%m', ""STUDYDATETIME"") = '12' AND strftime('%Y', ""STUDYDATETIME"") = strftime('%Y', date('now')) ORDER BY ""STUDYDATETIME"" ASC LIMIT 1 ) WHERE ""abdomen_findings"" LIKE '%yes%' AND ""right_lung_findings"" LIKE '%yes%'","select (func_vqa(""have any tubes/lines related to the abdomen been noticed?"", t1.study_id)) and (func_vqa(""have any tubes/lines related to the right lung been noticed?"", t1.study_id)) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 19243401 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') and strftime('%m',tb_cxr.studydatetime) = '12' order by tb_cxr.studydatetime asc limit 1 ) ) as t1","Empty DataFrame
Columns: [STUDY_ID, study_id_related]
Index: []","Empty DataFrame
Columns: [(func_vqa(""have any tubes/lines related to the abdomen been noticed?"", t1.study_id)) and (func_vqa(""have any tubes/lines related to the right lung been noticed?"", t1.study_id))]
Index: []",False,True,local
71,"SELECT ""SUBJECT_ID"", ""HADM_ID"", ""STUDY_ID"", func_vqa('airspace opacity or aspiration', ""STUDY_ID"") FROM TB_CXR WHERE ""STUDY_ID"" = 55277734;","select (func_vqa(""can you find airspace opacity?"", t1.study_id)) or (func_vqa(""can you find aspiration?"", t1.study_id)) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 55277734 ) as t1","   subject_id     hadm_id  study_id  \
0    17201840  22870487.0  55277734   

  func_vqa('airspace opacity or aspiration', ""STUDY_ID"")  
0                                                         ","   (func_vqa(""can you find airspace opacity?"", t1.study_id)) or (func_vqa(""can you find aspiration?"", t1.study_id))
0                                                  1                                                               ",False,False,local
111,"SELECT func_vqa(""Give all anatomical sites associated with anatomical findings"", ""STUDY_ID"") AS ""Anatomical_Sites"" FROM ""TB_CXR"" WHERE ""SUBJECT_ID"" = 16015533 ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select func_vqa(""please identify all anatomical sites associated with any anatomical findings."", t1.study_id) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 16015533 order by tb_cxr.studydatetime desc limit 1 ) ) as t1","                                    Anatomical_Sites
0  left costophrenic angle, left lower lung zone,...","  func_vqa(""please identify all anatomical sites associated with any anatomical findings."", t1.study_id)
0  left costophrenic angle, left lower lung zone,...                                                    ",False,True,local
163,"SELECT func_vqa(""enumerate all detected abnormalities"", ""STUDY_ID"") FROM ""TB_CXR"" WHERE ""STUDY_ID"" = 57883509;","select func_vqa(""enumerate all detected abnormalities."", t1.study_id) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 57883509 ) as t1","  func_vqa(""enumerate all detected abnormalities"", ""STUDY_ID"")
0                                       lung opacity          ","  func_vqa(""enumerate all detected abnormalities."", t1.study_id)
0                                       lung opacity            ",False,True,local
439,"SELECT ""LOCATION"" FROM func_vqa(""What are the anatomical locations associated with anatomical findings?"", ""59940756"");","select func_vqa(""specify all anatomical locations associated with any anatomical findings."", t1.study_id) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 59940756 ) as t1","                                               error
0  Database error occurred: Execution failed on s...","  func_vqa(""specify all anatomical locations associated with any anatomical findings."", t1.study_id)
0  left lower lung zone, left lung, mediastinum, ...                                                ",False,False,local
460,"SELECT func_vqa(""Which anatomical area is associated with vascular calcification, the mediastinum or the upper mediastinum?"", ""STUDY_ID"") FROM ""TB_CXR"" WHERE ""SUBJECT_ID"" = 18386349 ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select func_vqa(""which anatomical area is associated with vascular calcification, the mediastinum or the upper mediastinum?"", t1.study_id) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 18386349 order by tb_cxr.studydatetime desc limit 1 ) ) as t1","  func_vqa(""Which anatomical area is associated with vascular calcification, the mediastinum or the upper mediastinum?"", ""STUDY_ID"")
0                                  upper mediastinum                                                                                ","  func_vqa(""which anatomical area is associated with vascular calcification, the mediastinum or the upper mediastinum?"", t1.study_id)
0                                  upper mediastinum                                                                                 ",False,True,local
518,"SELECT func_vqa(""What are the observed abnormalities?"", ""STUDY_ID"") FROM ""TB_CXR"" WHERE ""STUDY_ID"" = 50078800;","select func_vqa(""outline all the observed abnormalities."", t1.study_id) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 50078800 ) as t1","  func_vqa(""What are the observed abnormalities?"", ""STUDY_ID"")
0                    endotracheal tube, lung opacity          ","  func_vqa(""outline all the observed abnormalities."", t1.study_id)
0                    endotracheal tube, lung opacity              ",False,True,local
10,"SELECT FUNC_VQA(""Are there cardiac pacer and wires present?"", ""57179088"") AS ""57179088_pacer_and_wires"", FUNC_VQA(""Are there cardiac pacer and wires present?"", ""54711520"") AS ""54711520_pacer_and_wires"" ;","select ( select (func_vqa(""are there cardiac pacer and wires?"", t1.study_id) = true) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 57179088 ) as t1 ) and ( select (func_vqa(""are there cardiac pacer and wires?"", t2.study_id) = true) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 54711520 ) as t2 )","   57179088_pacer_and_wires  54711520_pacer_and_wires
0                         1                         1","   ( select (func_vqa(""are there cardiac pacer and wires?"", t1.study_id) = true) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 57179088 ) as t1 ) and ( select (func_vqa(""are there cardiac pacer and wires?"", t2.study_id) = true) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 54711520 ) as t2 )
0                                                  1                                                                                                                                                                                                                                                                                        ",False,False,local
13,"SELECT ""STUDY_ID"", func_vqa(""Is there any evidence of abnormalities still absent?"") as ""Abnormalities_Still_Absent"" FROM ""TB_CXR"" WHERE ""STUDY_ID"" = 55949143 ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select ( select (func_vqa(""is there any evidence of abnormality?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 55949143 ) as t1 ) and ( select (func_vqa(""is there any evidence of abnormality?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = ( select distinct tb_cxr.subject_id from tb_cxr where tb_cxr.study_id = 55949143 ) and tb_cxr.studydatetime < ( select tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id = 55949143 ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )","                                               error
0  Database error occurred: Execution failed on s...","   ( select (func_vqa(""is there any evidence of abnormality?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id = 55949143 ) as t1 ) and ( select (func_vqa(""is there any evidence of abnormality?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = ( select distinct tb_cxr.subject_id from tb_cxr where tb_cxr.study_id = 55949143 ) and tb_cxr.studydatetime < ( select tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id = 55949143 ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )
0                                                  0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ",False,False,local
39,"SELECT ""STUDY_ID"", func_vqa(""Do the findings indicate any technical assessments still absent compared to the earlier study?"", ""STUDY_ID"") AS ""Assessment_Status"" FROM TB_CXR WHERE ""SUBJECT_ID"" = 12716528 ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select ( select (func_vqa(""do the findings indicate any technical assessments?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 12716528 and strftime('%y',tb_cxr.studydatetime) = '2103' order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""do the findings indicate any technical assessments?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 12716528 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 12716528 and strftime('%y',tb_cxr.studydatetime) = '2103' order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )","   study_id Assessment_Status
0  50289197                  ","   ( select (func_vqa(""do the findings indicate any technical assessments?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 12716528 and strftime('%Y',tb_cxr.studydatetime) = '2103' order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""do the findings indicate any technical assessments?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 12716528 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 12716528 and strftime('%Y',tb_cxr.studydatetime) = '2103' order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )
0                                                  0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ",False,False,local
76,"SELECT func_vqa(""compared to the previous study, does the last study for patient 17281190 this year reveal any abnormalities in the left mid lung zone still absent?"", ""STUDY_ID"") FROM ""TB_CXR"" WHERE ""SUBJECT_ID"" = 17281190 AND strftime('%Y', ""STUDYDATETIME"") = strftime('%Y', 'now') ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select ( select (func_vqa(""does the left mid lung zone reveal any abnormality?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17281190 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""does the left mid lung zone reveal any abnormality?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17281190 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17281190 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )","Empty DataFrame
Columns: [func_vqa(""compared to the previous study, does the last study for patient 17281190 this year reveal any abnormalities in the left mid lung zone still absent?"", ""STUDY_ID"")]
Index: []","  ( select (func_vqa(""does the left mid lung zone reveal any abnormality?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17281190 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""does the left mid lung zone reveal any abnormality?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17281190 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17281190 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )
0                                               None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ",False,False,local
106,"SELECT func_vqa(""does the second to last study reveal still present fluid overload/heart failure in the right lung compared to the first study this year?"", ""STUDY_ID"") FROM TB_CXR WHERE ""SUBJECT_ID"" = 16345504 AND strftime('%Y', ""STUDYDATETIME"") = strftime('%Y', date('now')) ORDER BY ""STUDYDATETIME"" LIMIT 1 OFFSET 1;","select ( select (func_vqa(""does the right lung reveal fluid overload/heart failure?"", t1.study_id) = true) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 16345504 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 offset 1 ) ) as t1 ) and ( select (func_vqa(""does the right lung reveal fluid overload/heart failure?"", t2.study_id) = true) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 16345504 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime asc limit 1 ) ) as t2 )","Empty DataFrame
Columns: [func_vqa(""does the second to last study reveal still present fluid overload/heart failure in the right lung compared to the first study this year?"", ""STUDY_ID"")]
Index: []","  ( select (func_vqa(""does the right lung reveal fluid overload/heart failure?"", t1.study_id) = true) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 16345504 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 offset 1 ) ) as t1 ) and ( select (func_vqa(""does the right lung reveal fluid overload/heart failure?"", t2.study_id) = true) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 16345504 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime asc limit 1 ) ) as t2 )
0                                               None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ",False,False,local
256,"SELECT ""anatomical_location"" FROM func_vqa(""enumerate all anatomical locations related to any technical assessments that are still present based on the first study on the last hospital visit compared to the previous study"", ""study_id"") WHERE ""study_id"" IN ( SELECT DISTINCT ""study_id"" FROM TB_CXR cxr JOIN ( SELECT ""HADM_ID"", ""STUDY_ID"" FROM TB_CXR WHERE ""SUBJECT_ID"" = 16476036 ORDER BY ""STUDYDATETIME"" DESC LIMIT 2 ) sub ON cxr.""HADM_ID"" = sub.""HADM_ID"" AND cxr.""STUDY_ID"" = sub.""STUDY_ID"" )","select func_vqa(""enumerate all anatomical locations related to any technical assessments."", t1.study_id) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 16476036 and admissions.dischtime is not null order by admissions.admittime desc limit 1 ) order by tb_cxr.studydatetime asc limit 1 ) ) as t1 intersect select func_vqa(""enumerate all anatomical locations related to any technical assessments."", t2.study_id) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 16476036 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 16476036 and admissions.dischtime is not null order by admissions.admittime desc limit 1 ) order by tb_cxr.studydatetime asc limit 1 ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2","                                               error
0  Database error occurred: Execution failed on s...","Empty DataFrame
Columns: [func_vqa(""enumerate all anatomical locations related to any technical assessments."", t1.study_id)]
Index: []",False,False,local
578,"SELECT func_vqa(""what anatomical findings in the right chest wall are still absent compared to the previous study?"", ""tb_cxr"".""STUDY_ID"") FROM ""TB_CXR"" WHERE ""TB_CXR"".""SUBJECT_ID"" = 10020740 AND strftime('%Y', ""TB_CXR"".""STUDYDATETIME"") = '2104' ORDER BY ""TB_CXR"".""STUDYDATETIME"" DESC LIMIT 1;","select ( select (func_vqa(""can you find any anatomical findings in the right chest wall?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10020740 and strftime('%y',tb_cxr.studydatetime) = '2104' order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""can you find any anatomical findings in the right chest wall?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10020740 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10020740 and strftime('%y',tb_cxr.studydatetime) = '2104' order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )","  func_vqa(""what anatomical findings in the right chest wall are still absent compared to the previous study?"", ""tb_cxr"".""STUDY_ID"")
0                                       rib fracture                                                                                ","   ( select (func_vqa(""can you find any anatomical findings in the right chest wall?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10020740 and strftime('%Y',tb_cxr.studydatetime) = '2104' order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""can you find any anatomical findings in the right chest wall?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10020740 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10020740 and strftime('%Y',tb_cxr.studydatetime) = '2104' order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )
0                                                  0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ",False,False,local
893,"SELECT ""study_id"", func_vqa(""compared to the previous study, does the first study for patient 13551252 on the first hospital visit reveal any diseases in the left costophrenic angle still absent?"") AS ""findings"" FROM TB_CXR WHERE ""SUBJECT_ID"" = 13551252 ORDER BY ""STUDYDATETIME"" ASC LIMIT 1;","select ( select (func_vqa(""does the left costophrenic angle reveal any diseases?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 13551252 and admissions.dischtime is not null order by admissions.admittime asc limit 1 ) order by tb_cxr.studydatetime asc limit 1 ) ) as t1 ) and ( select (func_vqa(""does the left costophrenic angle reveal any diseases?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 13551252 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 13551252 and admissions.dischtime is not null order by admissions.admittime asc limit 1 ) order by tb_cxr.studydatetime asc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )","                                               error
0  Database error occurred: Execution failed on s...","   ( select (func_vqa(""does the left costophrenic angle reveal any diseases?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 13551252 and admissions.dischtime is not null order by admissions.admittime asc limit 1 ) order by tb_cxr.studydatetime asc limit 1 ) ) as t1 ) and ( select (func_vqa(""does the left costophrenic angle reveal any diseases?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 13551252 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 13551252 and admissions.dischtime is not null order by admissions.admittime asc limit 1 ) order by tb_cxr.studydatetime asc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )
0                                                  1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ",False,False,local
1338,"SELECT func_vqa(""Are any tubes/lines in the right upper lung zone still absent compared to the previous study? for study 2103"") FROM ""TB_CXR"" WHERE ""SUBJECT_ID"" = 18916144 ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select ( select (func_vqa(""can you find any tubes/lines in the right upper lung zone?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 18916144 and strftime('%y',tb_cxr.studydatetime) = '2103' order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""can you find any tubes/lines in the right upper lung zone?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 18916144 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 18916144 and strftime('%y',tb_cxr.studydatetime) = '2103' order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )","                                               error
0  Database error occurred: Execution failed on s...","   ( select (func_vqa(""can you find any tubes/lines in the right upper lung zone?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 18916144 and strftime('%Y',tb_cxr.studydatetime) = '2103' order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""can you find any tubes/lines in the right upper lung zone?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 18916144 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 18916144 and strftime('%Y',tb_cxr.studydatetime) = '2103' order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )
0                                                  0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ",False,False,local
2496,"SELECT ""STUDY_ID"", func_vqa(""Are there any diseases in the right lower lung zone that are still absent compared to the previous study?"", ""STUDY_ID"") AS findings FROM TB_CXR WHERE ""SUBJECT_ID"" = 19103929 AND strftime('%Y', ""STUDYDATETIME"") = strftime('%Y', date('now')) ORDER BY ""STUDYDATETIME"" DESC LIMIT 1;","select ( select (func_vqa(""can you find any diseases in the right lower lung zone?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 19103929 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""can you find any diseases in the right lower lung zone?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 19103929 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 19103929 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )","Empty DataFrame
Columns: [study_id, findings]
Index: []","  ( select (func_vqa(""can you find any diseases in the right lower lung zone?"", t1.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 19103929 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) as t1 ) and ( select (func_vqa(""can you find any diseases in the right lower lung zone?"", t2.study_id) = false) from ( select tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 19103929 and tb_cxr.studydatetime < ( select distinct tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 19103929 and datetime(tb_cxr.studydatetime,'start of year') = datetime(current_time,'start of year','-0 year') order by tb_cxr.studydatetime desc limit 1 ) ) ) order by tb_cxr.studydatetime desc limit 1 ) as t2 )
0                                               None                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         ",False,False,local
1,"SELECT ""D1"".""ICD_CODE"" AS ""Diagnosis_ICD_Code"", func_vqa(""Was there any tube/line in the abdomen?"", ""T1"".""STUDY_ID"") AS ""VQA_Result"" FROM ""DIAGNOSES_ICD"" D1 JOIN ""ADMISSIONS"" A ON ""D1"".""HADM_ID"" = ""A"".""HADM_ID"" JOIN ""TB_CXR"" T1 ON ""A"".""SUBJECT_ID"" = ""T1"".""SUBJECT_ID"" WHERE ""D1"".""SUBJECT_ID"" = 12724975 AND ""A"".""ADMITTIME"" >= date('now', '-1 year') AND ""D1"".""ICD_CODE"" = (SELECT ""ICD_CODE"" FROM ""D_ICD_DIAGNOSES"" WHERE ""LONG_TITLE"" LIKE '%hypoxemia%') AND ""T1"".""STUDYDATETIME"" BETWEEN ""A"".""ADMITTIME"" AND ""A"".""DISCHTIME"";","select ( select count(*)>0 from diagnoses_icd where diagnoses_icd.icd_code = ( select d_icd_diagnoses.icd_code from d_icd_diagnoses where d_icd_diagnoses.long_title = 'hypoxemia' ) and diagnoses_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 12724975 ) and datetime(diagnoses_icd.charttime) <= datetime(current_time,'-1 year') ) and ( select count(distinct t1.study_id) > 0 from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 12724975 and datetime(tb_cxr.studydatetime) <= datetime(current_time,'-1 year') ) ) as t1 where func_vqa(""does a chest x-ray reveal any tubes/lines in the abdomen?"", t1.study_id) = true )","Empty DataFrame
Columns: [Diagnosis_ICD_Code, VQA_Result]
Index: []","   ( select count(*)>0 from diagnoses_icd where diagnoses_icd.icd_code = ( select d_icd_diagnoses.icd_code from d_icd_diagnoses where d_icd_diagnoses.long_title = 'hypoxemia' ) and diagnoses_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 12724975 ) and datetime(diagnoses_icd.charttime) <= datetime(current_time,'-1 year') ) and ( select count(distinct t1.study_id) > 0 from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 12724975 and datetime(tb_cxr.studydatetime) <= datetime(current_time,'-1 year') ) ) as t1 where func_vqa(""does a chest x-ray reveal any tubes/lines in the abdomen?"", t1.study_id) = true )
0                                                  0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ",False,False,local
6,"SELECT ""P"".""SUBJECT_ID"", func_vqa(""did this patient have any abnormalities in the left costophrenic angle within the same month after being diagnosed with personal history of malignant neoplasm of rectum, rectosigmoid junction, and anus"", ""TB"".""STUDY_ID"") AS ""VQA_Result"" FROM ""PATIENTS"" ""P"" JOIN ""DIAGNOSES_ICD"" ""DIAG"" ON ""P"".""SUBJECT_ID"" = ""DIAG"".""SUBJECT_ID"" JOIN ""D_ICD_DIAGNOSES"" ""D_ICD"" ON ""DIAG"".""ICD_CODE"" = ""D_ICD"".""ICD_CODE"" JOIN ""TB_CXR"" ""TB"" ON ""P"".""SUBJECT_ID"" = ""TB"".""SUBJECT_ID"" AND strftime('%Y-%m', ""DIAG"".""CHARTTIME"") = strftime('%Y-%m', ""TB"".""STUDYDATETIME"") WHERE ""P"".""SUBJECT_ID"" = 10762986 AND ""D_ICD"".""LONG_TITLE"" LIKE '%personal history of malignant neoplasm of rectum, rectosigmoid junction, and anus%' AND strftime('%Y', ""DIAG"".""CHARTTIME"") >= 2103;","select count(*)>0 from ( select diagnoses_icd.charttime from diagnoses_icd where diagnoses_icd.icd_code = ( select d_icd_diagnoses.icd_code from d_icd_diagnoses where d_icd_diagnoses.long_title = 'personal history of malignant neoplasm of rectum, rectosigmoid junction, and anus' ) and diagnoses_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 10762986 ) and strftime('%y',diagnoses_icd.charttime) >= '2103' ) as t1 join ( select tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select distinct t2.study_id from ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10762986 and strftime('%y',tb_cxr.studydatetime) >= '2103' ) ) as t2 where func_vqa(""is any abnormality shown in the left costophrenic angle on a chest x-ray?"", t2.study_id) = true ) ) as t3 where t1.charttime < t3.studydatetime and datetime(t1.charttime,'start of month') = datetime(t3.studydatetime,'start of month')","   subject_id VQA_Result
0    10762986           
1    10762986           
2    10762986           ","   count(*)>0
0           1",False,False,local
11,"SELECT ""st"".""STUDY_ID"" FROM ""TB_CXR"" AS ""st"" JOIN ""DIAGNOSES_ICD"" AS ""di"" ON ""st"".""SUBJECT_ID"" = ""di"".""SUBJECT_ID"" JOIN ""D_ICD_DIAGNOSES"" AS ""d_icd"" ON ""di"".""ICD_CODE"" = ""d_icd"".""ICD_CODE"" WHERE ""di"".""SUBJECT_ID"" = 10405915 AND ""d_icd"".""LONG_TITLE"" = 'Unspecified pleural effusion' AND ""di"".""CHARTTIME"" BETWEEN date('now', '-2 years') AND date('now', '-1 years') AND strftime('%Y-%m', ""st"".""STUDYDATETIME"") = strftime('%Y-%m', ""di"".""CHARTTIME"", '+1 month') AND 'yes' IN (SELECT value FROM func_vqa(""Does the chest x-ray show any abnormalities in the left hemidiaphragm?"", ""st"".""STUDY_ID""))","select count(*)>0 from ( select diagnoses_icd.charttime from diagnoses_icd where diagnoses_icd.icd_code = ( select d_icd_diagnoses.icd_code from d_icd_diagnoses where d_icd_diagnoses.long_title = 'unspecified pleural effusion' ) and diagnoses_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 10405915 ) and datetime(diagnoses_icd.charttime) >= datetime(current_time,'-2 year') ) as t1 join ( select tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select distinct t2.study_id from ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10405915 and datetime(tb_cxr.studydatetime) >= datetime(current_time,'-2 year') ) ) as t2 where func_vqa(""is any abnormality shown in the left hemidiaphragm on a chest x-ray?"", t2.study_id) = true ) ) as t3 where t1.charttime < t3.studydatetime and datetime(t1.charttime,'start of month') = datetime(t3.studydatetime,'start of month')","                                               error
0  Database error occurred: Execution failed on s...","   count(*)>0
0           1",False,False,local
12,"SELECT ""PROC"".""HADM_ID"", ""PROC"".""ICD_CODE"", ""CXR"".""STUDY_ID"", ""CXR"".""IMAGE_ID"", func_vqa(""CYST/BULLAE IN THE RIGHT MID LUNG ZONE"", CXR.""STUDY_ID"") AS ""VQA_RESULTS"" FROM ""PROCEDURES_ICD"" AS ""PROC"" JOIN ""TB_CXR"" AS ""CXR"" ON ""PROC"".""SUBJECT_ID"" = ""CXR"".""SUBJECT_ID"" WHERE ""PROC"".""SUBJECT_ID"" = 11320106 AND ""PROC"".""CHARTTIME"" >= '2105-01-01' AND ""VQA_RESULTS"" LIKE '%yes%'","select ( select count(*)>0 from procedures_icd where procedures_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 11320106 ) and strftime('%y',procedures_icd.charttime) >= '2105' ) and ( select count(distinct t1.study_id) > 0 from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 11320106 and strftime('%y',tb_cxr.studydatetime) >= '2105' ) ) as t1 where func_vqa(""is cyst/bullae visible in the right mid lung zone on a chest x-ray?"", t1.study_id) = true )","Empty DataFrame
Columns: [hadm_id, icd_code, study_id, image_id, VQA_RESULTS]
Index: []","   ( select count(*)>0 from procedures_icd where procedures_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 11320106 ) and strftime('%Y',procedures_icd.charttime) >= '2105' ) and ( select count(distinct t1.study_id) > 0 from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 11320106 and strftime('%Y',tb_cxr.studydatetime) >= '2105' ) ) as t1 where func_vqa(""is cyst/bullae visible in the right mid lung zone on a chest x-ray?"", t1.study_id) = true )
0                                                  1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            ",False,False,local
16,"SELECT ""DIAGNOSES_ICD"".""SUBJECT_ID"", ""DIAGNOSES_ICD"".""ICD_CODE"" FROM ""DIAGNOSES_ICD"" JOIN ""D_ICD_DIAGNOSES"" ON ""DIAGNOSES_ICD"".""ICD_CODE"" = ""D_ICD_DIAGNOSES"".""ICD_CODE"" JOIN ""TB_CXR"" ON ""DIAGNOSES_ICD"".""SUBJECT_ID"" = ""TB_CXR"".""SUBJECT_ID"" WHERE ""DIAGNOSES_ICD"".""SUBJECT_ID"" = 18855412 AND ""D_ICD_DIAGNOSES"".""LONG_TITLE"" = 'Pneumonitis due to inhalation of food and vomit' AND func_vqa(""question"" => ""contains any devices?"", ""study_id"" => ""TB_CXR"".""STUDY_ID"") IN ('yes') AND ""TB_CXR"".""STUDYDATETIME"" >= date('now', '-9 months') AND ""DIAGNOSES_ICD"".""CHARTTIME"" <= datetime(""TB_CXR"".""STUDYDATETIME"", '+2 days') AND ""DIAGNOSES_ICD"".""CHARTTIME"" >= ""TB_CXR"".""STUDYDATETIME"";","select count(*)>0 from ( select tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select distinct t2.study_id from ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 18855412 and datetime(tb_cxr.studydatetime) >= datetime(current_time,'-9 month') ) ) as t2 where func_vqa(""does a chest x-ray show any devices?"", t2.study_id) = true ) ) as t1 join ( select diagnoses_icd.charttime from diagnoses_icd where diagnoses_icd.icd_code = ( select d_icd_diagnoses.icd_code from d_icd_diagnoses where d_icd_diagnoses.long_title = 'pneumonitis due to inhalation of food and vomit' ) and diagnoses_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 18855412 ) and datetime(diagnoses_icd.charttime) >= datetime(current_time,'-9 month') ) as t3 where t1.studydatetime < t3.charttime and ( datetime(t3.charttime) between datetime(t1.studydatetime) and datetime(t1.studydatetime,'+2 day') ) or ( datetime(t1.studydatetime) between datetime(t3.charttime) and datetime(t3.charttime,'+2 day') )","                                               error
0  Database error occurred: Execution failed on s...","   count(*)>0
0           1",False,False,local
25,"SELECT ""SUBJECT_ID"", ""HADM_ID"", ""STUDY_ID"", func_vqa('Did the chest x-ray show any technical assessments?', ""STUDY_ID"") AS ""TECHNICAL_ASSESSMENTS"" FROM TB_CXR WHERE ""SUBJECT_ID"" = 11218589 AND ""STUDYDATETIME"" BETWEEN ( SELECT ""CHARTTIME"" FROM DIAGNOSES_ICD WHERE ""SUBJECT_ID"" = 11218589 AND ""ICD_CODE"" IN ( SELECT ""ICD_CODE"" FROM D_ICD_DIAGNOSES WHERE ""LONG_TITLE"" = 'Other chronic pulmonary heart diseases' ) AND strftime('%m/%Y', ""CHARTTIME"") = '05/2012' ) AND datetime(( SELECT ""CHARTTIME"" FROM DIAGNOSES_ICD WHERE ""SUBJECT_ID"" = 11218589 AND ""ICD_CODE"" IN ( SELECT ""ICD_CODE"" FROM D_ICD_DIAGNOSES WHERE ""LONG_TITLE"" = 'Other chronic pulmonary heart diseases' ) AND strftime('%m/%Y', ""CHARTTIME"") = '05/2012' ), '2 days');","select count(*)>0 from ( select diagnoses_icd.charttime from diagnoses_icd where diagnoses_icd.icd_code = ( select d_icd_diagnoses.icd_code from d_icd_diagnoses where d_icd_diagnoses.long_title = 'other chronic pulmonary heart diseases' ) and diagnoses_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 11218589 ) and strftime('%y-%m',diagnoses_icd.charttime) = '2102-05' ) as t1 join ( select tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select distinct t2.study_id from ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 11218589 and strftime('%y-%m',tb_cxr.studydatetime) = '2102-05' ) ) as t2 where func_vqa(""does a chest x-ray show any technical assessments?"", t2.study_id) = true ) ) as t3 where t1.charttime < t3.studydatetime and ( datetime(t3.studydatetime) between datetime(t1.charttime) and datetime(t1.charttime,'+2 day') ) or ( datetime(t1.charttime) between datetime(t3.studydatetime) and datetime(t3.studydatetime,'+2 day') )","Empty DataFrame
Columns: [subject_id, hadm_id, study_id, TECHNICAL_ASSESSMENTS]
Index: []","   count(*)>0
0           0",False,False,local
32,"SELECT CASE WHEN COUNT(*) > 0 THEN 'yes' ELSE 'no' END AS received_diagnosis FROM TB_CXR cxr JOIN DIAGNOSES_ICD diag ON cxr.""SUBJECT_ID"" = diag.""SUBJECT_ID"" JOIN D_ICD_DIAGNOSES d_diag ON diag.""ICD_CODE"" = d_diag.""ICD_CODE"" WHERE cxr.""SUBJECT_ID"" = 17466107 AND 'disorders of magnesium metabolism' IN (SELECT value FROM func_vqa(""Did the patient have disorders of magnesium metabolism?"", cxr.""STUDY_ID"")) AND d_diag.""LONG_TITLE"" LIKE '%disorders of magnesium metabolism%' AND diag.""CHARTTIME"" BETWEEN datetime(cxr.""STUDYDATETIME"", '+0 month') AND datetime(cxr.""STUDYDATETIME"", '+1 month') AND datetime(cxr.""STUDYDATETIME"") <= datetime('2100-01-01');","select count(*)>0 from ( select tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select distinct t2.study_id from ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17466107 and strftime('%y',tb_cxr.studydatetime) <= '2100' ) ) as t2 where func_vqa(""does a chest x-ray reveal any diseases?"", t2.study_id) = true ) ) as t1 join ( select diagnoses_icd.charttime from diagnoses_icd where diagnoses_icd.icd_code = ( select d_icd_diagnoses.icd_code from d_icd_diagnoses where d_icd_diagnoses.long_title = 'disorders of magnesium metabolism' ) and diagnoses_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 17466107 ) and strftime('%y',diagnoses_icd.charttime) <= '2100' ) as t3 where t1.studydatetime < t3.charttime and datetime(t1.studydatetime,'start of month') = datetime(t3.charttime,'start of month')","                                               error
0  Database error occurred: Execution failed on s...","   count(*)>0
0           0",False,False,local
47,"SELECT ""p"".""SUBJECT_ID"", ""p"".""HADM_ID"", ""p"".""STUDY_ID"", ""pi"".""ICD_CODE"", ""pi"".""CHARTTIME"" FROM ""TB_CXR"" AS ""p"" JOIN ""PROCEDURES_ICD"" AS ""pi"" ON ""p"".""SUBJECT_ID"" = ""pi"".""SUBJECT_ID"" WHERE ""p"".""SUBJECT_ID"" = 15212228 AND ""p"".""STUDYDATETIME"" >= date('now', '-2 years') AND 'right lower lung zone' IN (SELECT func_vqa('were there any abnormalities in the right lower lung zone', ""p"".""STUDY_ID"")) AND ""pi"".""ICD_CODE"" = ( SELECT ""ICD_CODE"" FROM ""D_ICD_PROCEDURES"" WHERE ""LONG_TITLE"" = 'Other cervical fusion of the anterior column, anterior technique' ) AND ""pi"".""CHARTTIME"" <= date(""p"".""STUDYDATETIME"", '+2 months') AND ""pi"".""CHARTTIME"" >= ""p"".""STUDYDATETIME"";","select count(*)>0 from ( select tb_cxr.studydatetime from tb_cxr where tb_cxr.study_id in ( select distinct t2.study_id from ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 15212228 and datetime(tb_cxr.studydatetime) >= datetime(current_time,'-2 year') ) ) as t2 where func_vqa(""does a chest x-ray reveal any abnormality in the right lower lung zone?"", t2.study_id) = true ) ) as t1 join ( select procedures_icd.charttime from procedures_icd where procedures_icd.icd_code = ( select d_icd_procedures.icd_code from d_icd_procedures where d_icd_procedures.long_title = 'other cervical fusion of the anterior column, anterior technique' ) and procedures_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 15212228 ) and datetime(procedures_icd.charttime) >= datetime(current_time,'-2 year') ) as t3 where t1.studydatetime < t3.charttime and ( datetime(t3.charttime) between datetime(t1.studydatetime) and datetime(t1.studydatetime,'+2 month') ) or ( datetime(t1.studydatetime) between datetime(t3.charttime) and datetime(t3.charttime,'+2 month') )","Empty DataFrame
Columns: [subject_id, hadm_id, study_id, icd_code, charttime]
Index: []","   count(*)>0
0           0",False,False,local
48,"SELECT ""A"".""SUBJECT_ID"", ""P"".""LONG_TITLE"" AS ""Procedure_Description"", ""VQA"".""VALUE"" AS ""CXR_Finding"" FROM ""PROCEDURES_ICD"" AS ""P"" JOIN ""ADMISSIONS"" AS ""A"" ON ""P"".""SUBJECT_ID"" = ""A"".""SUBJECT_ID"" JOIN ""D_ICD_PROCEDURES"" AS ""DIP"" ON ""P"".""ICD_CODE"" = ""DIP"".""ICD_CODE"" JOIN ""TB_CXR"" AS ""CXR"" ON ""A"".""SUBJECT_ID"" = ""CXR"".""SUBJECT_ID"" CROSS JOIN func_vqa(""CXR"".""STUDY_ID"", ""Any diseases in the right lung"") AS ""VQA"" WHERE ""A"".""SUBJECT_ID"" = 10037020 AND ""DIP"".""LONG_TITLE"" = 'Extirpation of matter from common bile duct, via natural or artificial opening endoscopic' AND ""CXR"".""STUDYDATETIME"" >= date('2014-08-01');","select ( select count(*)>0 from procedures_icd where procedures_icd.icd_code = ( select d_icd_procedures.icd_code from d_icd_procedures where d_icd_procedures.long_title = 'extirpation of matter from common bile duct, via natural or artificial opening endoscopic' ) and procedures_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 10037020 ) and strftime('%y-%m',procedures_icd.charttime) >= '2104-08' ) and ( select count(distinct t1.study_id) > 0 from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10037020 and strftime('%y-%m',tb_cxr.studydatetime) >= '2104-08' ) ) as t1 where func_vqa(""has a chest x-ray shown any diseases in the right lung?"", t1.study_id) = true )","                                               error
0  Database error occurred: Execution failed on s...","   ( select count(*)>0 from procedures_icd where procedures_icd.icd_code = ( select d_icd_procedures.icd_code from d_icd_procedures where d_icd_procedures.long_title = 'extirpation of matter from common bile duct, via natural or artificial opening endoscopic' ) and procedures_icd.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 10037020 ) and strftime('%Y-%m',procedures_icd.charttime) >= '2104-08' ) and ( select count(distinct t1.study_id) > 0 from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 10037020 and strftime('%Y-%m',tb_cxr.studydatetime) >= '2104-08' ) ) as t1 where func_vqa(""has a chest x-ray shown any diseases in the right lung?"", t1.study_id) = true )
0                                                  1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     ",False,False,local
50,"SELECT ""P"".""SUBJECT_ID"", ""P"".""HADM_ID"", ""P"".""STARTTIME"", ""P"".""STOPTIME"", ""TB"".""STUDY_ID"", ""TB"".""STUDYDATETIME"" FROM ""PRESCRIPTIONS"" AS ""P"" JOIN ""TB_CXR"" AS ""TB"" ON ""P"".""SUBJECT_ID"" = ""TB"".""SUBJECT_ID"" WHERE ""P"".""SUBJECT_ID"" = 17766862 AND ""P"".""DRUG"" = 'sodium chloride 0.9% flush' AND ""TB"".""STUDYDATETIME"" BETWEEN ""P"".""STARTTIME"" AND ""P"".""STOPTIME"" AND 'tubes/lines in the left shoulder' IN (SELECT value FROM func_vqa(""TB"".""STUDY_ID"", ""tubes/lines in the left shoulder""));","select ( select count(*)>0 from prescriptions where prescriptions.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 17766862 ) and prescriptions.drug = 'sodium chloride 0.9%  flush' ) and ( select count(distinct t1.study_id) > 0 from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17766862 ) ) as t1 where func_vqa(""is any tubes/lines depicted in the left shoulder on a chest x-ray?"", t1.study_id) = true )","                                               error
0  Database error occurred: Execution failed on s...","   ( select count(*)>0 from prescriptions where prescriptions.hadm_id in ( select admissions.hadm_id from admissions where admissions.subject_id = 17766862 ) and prescriptions.drug = 'sodium chloride 0.9%  flush' ) and ( select count(distinct t1.study_id) > 0 from ( select tb_cxr.study_id from tb_cxr where tb_cxr.study_id in ( select distinct tb_cxr.study_id from tb_cxr where tb_cxr.subject_id = 17766862 ) ) as t1 where func_vqa(""is any tubes/lines depicted in the left shoulder on a chest x-ray?"", t1.study_id) = true )
0                                                  1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ",False,False,local
